<h2 mat-dialog-title>{{isEditMode ? 'Edit' : 'Create'}} Journey</h2>

<form [formGroup]="journeyForm" (ngSubmit)="onSubmit()">
  <mat-dialog-content>
    <div class="form-container">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Code</mat-label>
        <input matInput formControlName="code" placeholder="Enter journey code">
        <mat-error *ngIf="journeyForm.get('code')?.hasError('required')">Code is required</mat-error>
        <mat-error *ngIf="journeyForm.get('code')?.hasError('pattern')">Code must contain only letters and numbers</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea matInput formControlName="description" placeholder="Enter journey description"></textarea>
        <mat-error *ngIf="journeyForm.get('description')?.hasError('required')">Description is required</mat-error>
      </mat-form-field>

      <div class="stops-section">
        <h3>Available Stops</h3>
        <mat-selection-list #stopsList>
          <mat-list-option *ngFor="let stop of stops" [value]="stop" (click)="addStop(stop)">
            {{stop.code}} - {{stop.description}}
          </mat-list-option>
        </mat-selection-list>
      </div>

      <div class="selected-stops-section">
        <h3>Selected Stops (Drag to reorder)</h3>
        <div cdkDropList class="selected-stops-list" (cdkDropListDropped)="drop($event)">
          <div class="selected-stop-item" *ngFor="let stop of selectedStops" cdkDrag>
            <span cdkDragHandle>{{stop.code}} - {{stop.description}}</span>
            <button mat-icon-button color="warn" (click)="removeStop(stop)">
              <mat-icon>remove_circle</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button type="button" (click)="onCancel()">Cancel</button>
    <button mat-raised-button color="primary" type="submit" [disabled]="!journeyForm.valid || selectedStops.length === 0">
      {{isEditMode ? 'Update' : 'Create'}}
    </button>
  </mat-dialog-actions>
</form> 